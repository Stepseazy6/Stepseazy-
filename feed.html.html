<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Public Feed - Maa Raksha</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --saffron: #FF9933;
            --white: #FFFFFF;
            --green: #138808;
            --navy: #000080;
            --dark: #0F172A;
            --light: #F8FAFC;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f0f2f5;
            color: var(--dark);
        }

        .feed-header {
            background: white;
            padding: 15px 5%;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: bold;
            font-size: 1.2rem;
            color: var(--navy);
        }

        .logo i {
            color: var(--saffron);
        }

        .location-filter {
            background: white;
            margin-top: 70px;
            padding: 15px 5%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        .location-btn {
            padding: 8px 20px;
            border-radius: 20px;
            background: #f0f2f5;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .location-btn.active {
            background: var(--saffron);
            color: white;
        }

        .location-btn:hover {
            transform: translateY(-2px);
        }

        .all-india {
            background: linear-gradient(90deg, #FF9933, #FFFFFF, #138808);
            color: var(--navy);
            font-weight: bold;
        }

        .search-box {
            flex-grow: 1;
            max-width: 400px;
        }

        .search-box input {
            width: 100%;
            padding: 10px 20px;
            border-radius: 25px;
            border: 1px solid #ddd;
            font-size: 14px;
        }

        .feed-container {
            max-width: 600px;
            margin: 140px auto 20px;
            padding: 0 5%;
        }

        .complaint-post {
            background: white;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: transform 0.3s;
        }

        .complaint-post:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }

        .post-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #eee;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--saffron);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .anonymous .user-avatar {
            background: #666;
        }

        .user-details h4 {
            font-size: 16px;
            margin-bottom: 3px;
        }

        .user-details p {
            font-size: 12px;
            color: #666;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .post-time {
            font-size: 12px;
            color: #999;
        }

        .media-container {
            position: relative;
            background: #000;
            max-height: 500px;
            overflow: hidden;
        }

        .media-container video,
        .media-container img {
            width: 100%;
            height: auto;
            display: block;
        }

        .blur-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
        }

        .post-content {
            padding: 15px;
        }

        .post-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--dark);
        }

        .post-description {
            font-size: 14px;
            line-height: 1.5;
            margin-bottom: 15px;
            color: #555;
        }

        .post-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }

        .tag {
            background: #f0f2f5;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 12px;
            color: #666;
        }

        .tag.department {
            background: #e3f2fd;
            color: #1976d2;
        }

        .tag.urgent {
            background: #ffebee;
            color: #d32f2f;
        }

        .post-stats {
            display: flex;
            justify-content: space-between;
            padding: 10px 15px;
            border-top: 1px solid #eee;
            border-bottom: 1px solid #eee;
            font-size: 14px;
            color: #666;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .post-actions {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            padding: 10px;
        }

        .action-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            padding: 10px;
            border: none;
            background: none;
            cursor: pointer;
            color: #666;
            transition: all 0.3s;
            border-radius: 8px;
        }

        .action-btn:hover {
            background: #f0f2f5;
            color: var(--saffron);
        }

        .action-btn.active {
            color: var(--saffron);
        }

        .action-btn i {
            font-size: 20px;
        }

        .action-btn span {
            font-size: 12px;
        }

        .timer-badge {
            background: linear-gradient(90deg, #FF9933, #FF6B00);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .timer-badge.urgent {
            background: linear-gradient(90deg, #FF0000, #CC0000);
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        .fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--saffron), #FF8000);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            box-shadow: 0 5px 20px rgba(255, 153, 51, 0.4);
            z-index: 1000;
            text-decoration: none;
        }

        .fab-report {
            right: 30px;
        }

        .fab-location {
            right: 100px;
            background: linear-gradient(135deg, var(--green), #0D6E00);
        }

        .emergency-btn {
            position: fixed;
            bottom: 30px;
            left: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #FF0000, #CC0000);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            box-shadow: 0 5px 20px rgba(255, 0, 0, 0.4);
            z-index: 1000;
            text-decoration: none;
            animation: pulse 2s infinite;
        }

        @media (max-width: 768px) {
            .feed-container {
                margin-top: 150px;
                padding: 0 3%;
            }
            
            .location-filter {
                padding: 10px 3%;
            }
            
            .fab-location {
                right: 100px;
            }
            
            .post-actions {
                grid-template-columns: repeat(4, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="feed-header">
        <div class="logo">
            <i class="fas fa-shield-alt"></i>
            <span>Maa Raksha Feed</span>
        </div>
        
        <div class="search-box">
            <input type="text" placeholder="ðŸ” Search complaints, cities, departments..." id="searchInput">
        </div>
        
        <a href="index.html" style="color: var(--saffron); text-decoration: none;">
            <i class="fas fa-home"></i> Home
        </a>
    </header>

    <!-- Location Filter -->
    <div class="location-filter">
        <button class="location-btn all-india active" onclick="filterByLocation('all')">
            <i class="fas fa-flag"></i> All India
        </button>
        
        <button class="location-btn" onclick="filterByLocation('delhi')">
            <i class="fas fa-city"></i> Delhi
        </button>
        
        <button class="location-btn" onclick="filterByLocation('mumbai')">
            <i class="fas fa-city"></i> Mumbai
        </button>
        
        <button class="location-btn" onclick="filterByLocation('lucknow')">
            <i class="fas fa-city"></i> Lucknow
        </button>
        
        <button class="location-btn" onclick="filterByLocation('bangalore')">
            <i class="fas fa-city"></i> Bangalore
        </button>
        
        <select id="departmentFilter" onchange="filterByDepartment(this.value)" style="padding: 8px; border-radius: 20px; border: 1px solid #ddd;">
            <option value="all">All Departments</option>
            <option value="police">Police</option>
            <option value="rto">RTO</option>
            <option value="municipal">Municipal</option>
            <option value="hospital">Hospital</option>
            <option value="education">Education</option>
        </select>
    </div>

    <!-- Feed Container -->
    <div class="feed-container" id="feedContainer">
        <!-- Posts loaded by JavaScript -->
    </div>

    <!-- Floating Action Buttons -->
    <a href="report.html" class="fab fab-report">
        <i class="fas fa-plus"></i>
    </a>
    
    <button class="fab fab-location" onclick="getUserLocation()">
        <i class="fas fa-crosshairs"></i>
    </button>
    
    <a href="tel:112" class="emergency-btn">
        <i class="fas fa-phone-alt"></i>
    </a>

    <script>
        // Sample Complaints Data
        const complaintsData = [
            {
                id: 1,
                user: { name: "Anonymous User", avatar: "A", city: "Delhi" },
                type: "anonymous",
                title: "Traffic Police taking bribe at Rajouri Garden",
                description: "Traffic police officer demanding â‚¹500 bribe for not wearing helmet. Recorded secretly.",
                media: "https://images.unsplash.com/photo-1589652717521-10c0d092dea9?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
                city: "Delhi",
                department: "Police",
                tags: ["#PoliceCorruption", "#Traffic", "#Bribe"],
                time: "2 hours ago",
                upvotes: 245,
                comments: 42,
                shares: 18,
                status: "pending",
                timer: "45:12:00",
                urgent: true
            },
            {
                id: 2,
                user: { name: "Rahul Sharma", avatar: "RS", city: "Mumbai" },
                type: "public",
                title: "RTO officer asking â‚¹2000 for license",
                description: "At Andheri RTO office, officer openly asking for money to process driving license quickly.",
                media: "https://images.unsplash.com/photo-1549923746-2d86cc2e82d5?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
                city: "Mumbai",
                department: "RTO",
                tags: ["#RTOScam", "#DrivingLicense", "#Corruption"],
                time: "5 hours ago",
                upvotes: 189,
                comments: 31,
                shares: 12,
                status: "pending",
                timer: "42:30:00",
                urgent: true
            },
            {
                id: 3,
                user: { name: "Anonymous User", avatar: "A", city: "Lucknow" },
                type: "anonymous",
                title: "Municipal officer demanding money for water connection",
                description: "For new water connection, officer asking â‚¹5000 bribe. Have audio recording as proof.",
                media: "https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
                city: "Lucknow",
                department: "Municipal",
                tags: ["#WaterDepartment", "#Bribe", "#Corruption"],
                time: "1 day ago",
                upvotes: 156,
                comments: 28,
                shares: 9,
                status: "solved",
                timer: "00:00:00",
                urgent: false
            },
            {
                id: 4,
                user: { name: "Priya Singh", avatar: "PS", city: "Bangalore" },
                type: "public",
                title: "Government hospital doctor asking money for free surgery",
                description: "At Victoria Hospital, doctor demanding â‚¹10000 for free hernia surgery under Ayushman Bharat.",
                media: "https://images.unsplash.com/photo-1516549655669-df6654e435de?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
                city: "Bangalore",
                department: "Hospital",
                tags: ["#HospitalCorruption", "#AyushmanBharat", "#Healthcare"],
                time: "2 days ago",
                upvotes: 312,
                comments: 67,
                shares: 45,
                status: "pending",
                timer: "20:15:00",
                urgent: true
            },
            {
                id: 5,
                user: { name: "Anonymous User", avatar: "A", city: "Delhi" },
                type: "anonymous",
                title: "School principal taking donation for admission",
                description: "Government school principal asking â‚¹15000 as donation for nursery admission. Have WhatsApp chat proof.",
                media: "https://images.unsplash.com/photo-1523050854058-8df90110c9f1?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
                city: "Delhi",
                department: "Education",
                tags: ["#EducationScam", "#SchoolAdmission", "#Corruption"],
                time: "3 days ago",
                upvotes: 198,
                comments: 39,
                shares: 23,
                status: "pending",
                timer: "12:45:00",
                urgent: true
            }
        ];

        let currentFilter = {
            location: 'all',
            department: 'all',
            search: ''
        };

        document.addEventListener('DOMContentLoaded', function() {
            renderComplaints(complaintsData);
            setupInfiniteScroll();
        });

        function renderComplaints(complaints) {
            const container = document.getElementById('feedContainer');
            container.innerHTML = '';
            
            complaints.forEach(complaint => {
                const postHTML = createPostHTML(complaint);
                container.innerHTML += postHTML;
            });
            
            setTimeout(() => {
                document.querySelectorAll('.action-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const action = this.getAttribute('data-action');
                        const postId = this.getAttribute('data-post-id');
                        handlePostAction(action, postId, this);
                    });
                });
            }, 100);
        }

        function createPostHTML(complaint) {
            const isAnonymous = complaint.type === 'anonymous';
            const isUrgent = complaint.urgent;
            const timerClass = isUrgent ? 'timer-badge urgent' : 'timer-badge';
            
            return `
                <div class="complaint-post ${isAnonymous ? 'anonymous' : ''}" data-city="${complaint.city}" data-department="${complaint.department}">
                    <div class="post-header">
                        <div class="user-info">
                            <div class="user-avatar">${complaint.user.avatar}</div>
                            <div class="user-details">
                                <h4>${complaint.user.name}</h4>
                                <p>
                                    <i class="fas fa-location-dot"></i> ${complaint.city}
                                    <span style="margin: 0 5px">â€¢</span>
                                    <i class="fas fa-building"></i> ${complaint.department}
                                </p>
                            </div>
                        </div>
                        <div class="post-time">${complaint.time}</div>
                    </div>
                    
                    <div class="media-container">
                        <img src="${complaint.media}" alt="Complaint Media">
                        ${isAnonymous ? '<div class="blur-overlay"><i class="fas fa-user-secret"></i> Identity Protected</div>' : ''}
                    </div>
                    
                    <div class="post-content">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h3 class="post-title">${complaint.title}</h3>
                            <div class="${timerClass}">
                                <i class="fas fa-clock"></i> ${complaint.timer}
                            </div>
                        </div>
                        
                        <p class="post-description">${complaint.description}</p>
                        
                        <div class="post-tags">
                            ${complaint.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                            <span class="tag department">${complaint.department}</span>
                            ${isUrgent ? '<span class="tag urgent">URGENT</span>' : ''}
                        </div>
                    </div>
                    
                    <div class="post-stats">
                        <div class="stat-item">
                            <i class="fas fa-thumbs-up"></i> ${complaint.upvotes} upvotes
                        </div>
                        <div class="stat-item">
                            <i class="fas fa-comment"></i> ${complaint.comments} comments
                        </div>
                        <div class="stat-item">
                            <i class="fas fa-share"></i> ${complaint.shares} shares
                        </div>
                    </div>
                    
                    <div class="post-actions">
                        <button class="action-btn" data-action="upvote" data-post-id="${complaint.id}">
                            <i class="fas fa-thumbs-up"></i>
                            <span>Upvote</span>
                        </button>
                        
                        <button class="action-btn" data-action="comment" data-post-id="${complaint.id}">
                            <i class="fas fa-comment"></i>
                            <span>Comment</span>
                        </button>
                        
                        <button class="action-btn" data-action="share" data-post-id="${complaint.id}">
                            <i class="fas fa-share"></i>
                            <span>Share</span>
                        </button>
                        
                        <button class="action-btn" data-action="follow" data-post-id="${complaint.id}">
                            <i class="fas fa-bell"></i>
                            <span>Follow</span>
                        </button>
                    </div>
                </div>
            `;
        }

        function filterByLocation(location) {
            currentFilter.location = location;
            
            document.querySelectorAll('.location-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            applyFilters();
        }

        function filterByDepartment(department) {
            currentFilter.department = department;
            applyFilters();
        }

        document.getElementById('searchInput').addEventListener('input', function(e) {
            currentFilter.search = e.target.value.toLowerCase();
            applyFilters();
        });

        function applyFilters() {
            let filtered = complaintsData;
            
            if (currentFilter.location !== 'all') {
                filtered = filtered.filter(c => c.city.toLowerCase() === currentFilter.location.toLowerCase());
            }
            
            if (currentFilter.department !== 'all') {
                filtered = filtered.filter(c => c.department.toLowerCase() === currentFilter.department.toLowerCase());
            }
            
            if (currentFilter.search) {
                filtered = filtered.filter(c => 
                    c.title.toLowerCase().includes(currentFilter.search) ||
                    c.description.toLowerCase().includes(currentFilter.search) ||
                    c.tags.some(tag => tag.toLowerCase().includes(currentFilter.search)) ||
                    c.city.toLowerCase().includes(currentFilter.search) ||
                    c.department.toLowerCase().includes(currentFilter.search)
                );
            }
            
            renderComplaints(filtered);
        }

        function handlePostAction(action, postId, button) {
            const post = complaintsData.find(c => c.id == postId);
            
            switch(action) {
                case 'upvote':
                    post.upvotes++;
                    button.innerHTML = `<i class="fas fa-thumbs-up"></i><span>Upvoted (${post.upvotes})</span>`;
                    button.classList.add('active');
                    break;
                    
                case 'comment':
                    const comment = prompt('Enter your comment:');
                    if (comment) {
                        post.comments++;
                        alert('Comment added!');
                    }
                    break;
                    
                case 'share':
                    const shareUrl = `${window.location.origin}/complaint.html?id=${postId}`;
                    navigator.clipboard.writeText(shareUrl).then(() => {
                        alert('Link copied to clipboard! Share it on WhatsApp, Facebook, etc.');
                        post.shares++;
                    });
                    break;
                    
                case 'follow':
                    button.innerHTML = `<i class="fas fa-bell"></i><span>Following</span>`;
                    button.classList.add('active');
                    alert(`Now following updates for: ${post.title}`);
                    break;
            }
        }

        function getUserLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    position => {
                        filterByLocation('delhi');
                        alert(`Location detected! Showing complaints near Delhi.`);
                    },
                    error => {
                        alert('Unable to get location. Please select city manually.');
                    }
                );
            } else {
                alert('Geolocation is not supported by your browser.');
            }
        }

        function setupInfiniteScroll() {
            let loading = false;
            
            window.addEventListener('scroll', () => {
                if (loading) return;
                
                const scrollTop = window.pageYOffset;
                const windowHeight = window.innerHeight;
                const bodyHeight = document.body.offsetHeight;
                
                if (scrollTop + windowHeight >= bodyHeight - 500) {
                    loading = true;
                    loadMoreComplaints();
                }
            });
        }

        function loadMoreComplaints() {
            const loadingDiv = document.createElement('div');
            loadingDiv.innerHTML = `
                <div style="text-align: center; padding: 20px; color: #666;">
                    <i class="fas fa-spinner fa-spin"></i> Loading more complaints...
                </div>
            `;
            document.getElementById('feedContainer').appendChild(loadingDiv);
            
            setTimeout(() => {
                loadingDiv.remove();
                loading = false;
                
                const noMoreDiv = document.createElement('div');
                noMoreDiv.innerHTML = `
                    <div style="text-align: center; padding: 20px; color: #999;">
                        <i class="fas fa-check-circle"></i> You're all caught up!
                    </div>
                `;
                document.getElementById('feedContainer').appendChild(noMoreDiv);
            }, 1500);
        }
    </script>
</body>
</html>